"use strict";(self["webpackChunkideao"]=self["webpackChunkideao"]||[]).push([[989],{3989:(e,a,s)=>{s.r(a),s.d(a,{default:()=>L});s(71);var i=s(3673),l=s(2323);const t=e=>((0,i.dD)("data-v-2b205eff"),e=e(),(0,i.Cn)(),e),o=(0,i.uE)('<div class="menu" data-v-2b205eff><img class="icon" src="img/menu_50X50.svg" data-v-2b205eff></div><div class="setting" data-v-2b205eff><img class="icon" src="img/setting_50X50.svg" data-v-2b205eff></div><div class="logo" data-v-2b205eff><img class="icon" src="img/ideaocam_H35.svg" data-v-2b205eff></div><div class="full-screen" data-v-2b205eff><img class="icon" src="img/full-screen_50X50.svg" data-v-2b205eff></div><div class="snapshot-record" data-v-2b205eff><div class="icon-wrapper" data-v-2b205eff><img class="icon" src="img/snapshot_40X40.svg" data-v-2b205eff></div><div class="text" data-v-2b205eff>Snapshot &amp; Record</div></div><div class="stop-motion" data-v-2b205eff><div class="icon-wrapper" data-v-2b205eff><img class="icon" src="img/stop-motion_40X40.svg" data-v-2b205eff></div><div class="text" data-v-2b205eff>Stop Motion</div></div>',6),c={class:"countdown"},n={class:"camera"},v=t((()=>(0,i._)("div",null,null,-1))),d=t((()=>(0,i._)("div",null,null,-1))),u={class:"camera-video-mic"},r={class:"camera"},g={key:0,class:"video"},m={key:1,class:"video-mode"},f={class:"rec"},p=t((()=>(0,i._)("div",{class:"dot"},null,-1))),w=t((()=>(0,i._)("div",{class:"text"},"REC",-1))),_={class:"time"},b={key:0,class:"line"},h={key:1,class:"triangle"},k=t((()=>(0,i._)("div",{class:"square"},null,-1))),C=[k],y={class:"mic"},V=["src"],S={class:"camera-screen"},H={ref:"localVideo",autoplay:"",playsinline:"",muted:""},M={ref:"canvas",style:{display:"none"}};function I(e,a,s,t,k,I){const D=(0,i.up)("q-circular-progress");return(0,i.wg)(),(0,i.iD)(i.HY,null,[o,(0,i._)("div",c,[(0,i._)("div",n,[e.cameraCountdown>0?((0,i.wg)(),(0,i.j4)(D,{key:0,"show-value":"",value:e.cameraCountdownProgress,"font-size":"30px",size:"60px",thickness:.15,color:"white"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.cameraCountdown),1)])),_:1},8,["value","thickness"])):(0,i.kq)("",!0)]),v,d]),(0,i._)("div",u,[(0,i._)("div",r,[(0,i._)("img",{class:"icon",src:"img/camera_round_80X80.svg",onClick:a[0]||(a[0]=(...a)=>e.useCamera&&e.useCamera(...a))})]),e.isVideoMode?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",g,[(0,i._)("img",{class:"icon",src:"img/video_round_80X80.svg",onClick:a[1]||(a[1]=(...a)=>e.useVideoStart&&e.useVideoStart(...a))})])),e.isVideoMode?((0,i.wg)(),(0,i.iD)("div",m,[(0,i._)("div",f,[p,w,(0,i._)("div",_,(0,l.zw)(e.videoMinutes)+":"+(0,l.zw)(e.videoSeconds),1)]),(0,i._)("div",{class:"play-pause",onClick:a[2]||(a[2]=(...a)=>e.useVideoPause&&e.useVideoPause(...a))},[e.isPause?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("div",b)),e.isPause?((0,i.wg)(),(0,i.iD)("div",h)):(0,i.kq)("",!0)]),(0,i._)("div",{class:"stop",onClick:a[3]||(a[3]=(...a)=>e.useVideoStop&&e.useVideoStop(...a))},C)])):(0,i.kq)("",!0),(0,i._)("div",y,[e.isMic?((0,i.wg)(),(0,i.iD)("img",{key:0,class:"icon",src:"img/microphone_round_80X80.svg",onClick:a[4]||(a[4]=(...a)=>e.useMic&&e.useMic(...a))})):(0,i.kq)("",!0),e.isMic?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("img",{key:1,class:"icon",src:"img/microphone-off_round_80X80.svg",onClick:a[5]||(a[5]=(...a)=>e.useMic&&e.useMic(...a))}))])]),(0,i._)("div",{class:"thumbnail",onClick:a[6]||(a[6]=(...a)=>e.goViewer&&e.goViewer(...a))},[(0,i._)("img",{src:e.thumbnail},null,8,V)]),(0,i._)("div",S,[(0,i._)("video",H," Video stream not available. ",512),(0,i._)("canvas",M,null,512)])],64)}s(7965),s(6016);var D=s(1959),P=s(9582),q=s(3617);const x=(0,i.aZ)({name:"PageIndex",setup(){const e=(0,P.tv)(),a=(0,q.oR)(),s=(0,D.iH)(),l=(0,D.iH)(),t=(0,D.iH)(),o=(0,D.iH)(""),c=(0,D.iH)(!1),n=(0,D.iH)(!1),v=(0,D.iH)("00"),d=(0,D.iH)("00"),u=(0,D.iH)(!0),r=(0,D.iH)(1),g=(0,D.iH)(0),m=(0,D.iH)(0);let f=null,p=null,w="",_=[],b=null;const h=(0,D.Fl)((()=>a.getters["extension/viewers"])),k=e=>a.dispatch("extension/setViewers",e);(0,i.bv)((async()=>{await C()}));const C=async()=>{f=await navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),s.value.srcObject=f,p=new MediaRecorder(f),p.addEventListener("dataavailable",y),p.addEventListener("stop",V)},y=e=>{_.push(e.data)},V=e=>{t.value.controls=!0;var a=new Blob(_,{type:"video/webm; codecs=vp9"});_=[],w=URL.createObjectURL(a),t.value.src=w,console.log(w)},S=()=>{l.value.width=s.value.clientWidth,l.value.height=s.value.clientHeight;let e=l.value.getContext("2d");e.mozImageSmoothingEnabled=!1,e.webkitImageSmoothingEnabled=!1,e.msImageSmoothingEnabled=!1,e.imageSmoothingEnabled=!1,e.imageSmoothingQuality="high",e.drawImage(s.value,0,0,s.value.clientWidth,s.value.clientHeight);let a=l.value.toDataURL("image/jpeg");o.value=a;let i=Object.assign([],h.value);i.push({src:a}),k(i)},H=async()=>{if(r.value>0){g.value=r.value,m.value=1;let e=setInterval((()=>{g.value-=1,m.value=1/(r.value-1)*(r.value-g.value)*100,console.log(m.value),0==g.value&&(clearInterval(e),S())}),1e3)}else S()},M=()=>{v.value="00",d.value="00",b=setInterval((()=>{if(n.value)return;let e=parseInt(d.value)+1;if(d.value=("0"+e).slice(-2),0==e){let e=parseInt(v.value)+1;v.value=("0"+e).slice(-2)}}),1e3)},I=async()=>{c.value=!0,n.value=!1,p.start(10),M()},x=async()=>{c.value=!1,p.stop(),clearInterval(b)},E=async()=>{n.value=!n.value,"recording"===p.state?p.pause():"paused"===p.state&&(videoStartTime=new Date,p.resume())},X=()=>{u.value=!u.value,f.getAudioTracks().forEach((e=>{e.enabled=u.value}))},R=()=>{e.push({path:"/viewer"})};return{viewers:h,localVideo:s,canvas:l,outputVideo:t,thumbnail:o,isVideoMode:c,isPause:n,videoMinutes:v,videoSeconds:d,isMic:u,cameraCountdownSetting:r,cameraCountdown:g,cameraCountdownProgress:m,useCamera:H,useVideoStart:I,useVideoStop:x,useVideoPause:E,useMic:X,goViewer:R}}});var E=s(4260),X=s(7086),R=s(7518),z=s.n(R);const j=(0,E.Z)(x,[["render",I],["__scopeId","data-v-2b205eff"]]),L=j;z()(x,"components",{QCircularProgress:X.Z})}}]);